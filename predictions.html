<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>9c33fd151097456085661ac87d5d3df6</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data manipulation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Artificial intelligence</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastai</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.tabular.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization and formatting</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown, display</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> pd.read_csv(<span class="st">&#39;titanic/train.csv&#39;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_test <span class="op">=</span> pd.read_csv(<span class="st">&#39;titanic/test.csv&#39;</span>)</span></code></pre></div>
</div>
<section id="eda" class="cell markdown">
<h1>EDA</h1>
</section>
<div class="cell markdown">
<p><strong>Feature Laydown</strong></p>
<p>We can start by looking at the features that are available in the dataset and observing which ones might be useful to us.</p>
<ul>
<li>PassengerId: Unique identifier for each passenger.</li>
<li>Survived: A boolean indicating whether the passenger survived or not.</li>
<li>Pclass: A proxy for socio-economic status (SES).
<ul>
<li>1st = Upper</li>
<li>2nd = Middle</li>
<li>3rd = Lower</li>
</ul></li>
<li>Name: Name of passenger.</li>
<li>Sex: Sex of passenger.</li>
<li>Age: Age of passenger.</li>
<li>SibSp: Number of siblings / spouses aboard the Titanic.</li>
<li>Parch: Number of parents / children aboard the Titanic.</li>
<li>Fare: Passenger fare</li>
<li>Cabin: Cabin number of passenger.</li>
<li>Embarked: Port of embarkation.
<ul>
<li>C = Cherbourg</li>
<li>Q = Queenstown</li>
<li>S = Southampton</li>
</ul></li>
<li>WikiId: Irrelevant.</li>
<li>Name_wiki: Name of passenger on Wikipedia.</li>
<li>Age_wiki: Age of passenger on Wikipedia.</li>
<li>Hometown: Hometown of passenger.</li>
<li>Boarded: The city where the passenger boarded the Titanic (Cherbourg, Queenstown, Southampton).</li>
<li>Destination: The destination of the passenger.</li>
<li>Lifeboat: Which lifeboat the passenger was on.</li>
<li>Body: Irrelevant.</li>
<li>Class: An integer indicating the class of the passenger (First, Second, Third).</li>
</ul>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_train.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>...</th>
      <th>Embarked</th>
      <th>WikiId</th>
      <th>Name_wiki</th>
      <th>Age_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>Body</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>...</td>
      <td>S</td>
      <td>691.0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>Bridgerule, Devon, England</td>
      <td>Southampton</td>
      <td>Qu'Appelle Valley, Saskatchewan, Canada</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Thayer)</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>...</td>
      <td>C</td>
      <td>90.0</td>
      <td>Cumings, Mrs. Florence Briggs (née Thayer)</td>
      <td>35.0</td>
      <td>New York, New York, US</td>
      <td>Cherbourg</td>
      <td>New York, New York, US</td>
      <td>4</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1.0</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>...</td>
      <td>S</td>
      <td>865.0</td>
      <td>Heikkinen, Miss Laina</td>
      <td>26.0</td>
      <td>Jyväskylä, Finland</td>
      <td>Southampton</td>
      <td>New York City</td>
      <td>14?</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1.0</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>...</td>
      <td>S</td>
      <td>127.0</td>
      <td>Futrelle, Mrs. Lily May (née Peel)</td>
      <td>35.0</td>
      <td>Scituate, Massachusetts, US</td>
      <td>Southampton</td>
      <td>Scituate, Massachusetts, US</td>
      <td>D</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>...</td>
      <td>S</td>
      <td>627.0</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>Birmingham, West Midlands, England</td>
      <td>Southampton</td>
      <td>New York City</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<section id="preprocessing" class="cell markdown">
<h2>Preprocessing</h2>
</section>
<div class="cell markdown">
<p>To shrink the amount of features our model will have to handle and to remove features that would confuse the model, we can drop certain columns.</p>
<p>Notably, the column <strong>WikiId</strong> doesn't provide us any useful data as this is exclusive to Wikipedia. We can drop the <strong>Body</strong> column as it provides categorical data in forms of storage sizes, which has nothing to do with this model.</p>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> df_train.drop(columns<span class="op">=</span>[ <span class="st">&#39;WikiId&#39;</span>, <span class="st">&#39;Body&#39;</span> ])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Name_wiki</th>
      <th>Age_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>Bridgerule, Devon, England</td>
      <td>Southampton</td>
      <td>Qu'Appelle Valley, Saskatchewan, Canada</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Thayer)</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>Cumings, Mrs. Florence Briggs (née Thayer)</td>
      <td>35.0</td>
      <td>New York, New York, US</td>
      <td>Cherbourg</td>
      <td>New York, New York, US</td>
      <td>4</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1.0</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>Heikkinen, Miss Laina</td>
      <td>26.0</td>
      <td>Jyväskylä, Finland</td>
      <td>Southampton</td>
      <td>New York City</td>
      <td>14?</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1.0</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>Futrelle, Mrs. Lily May (née Peel)</td>
      <td>35.0</td>
      <td>Scituate, Massachusetts, US</td>
      <td>Southampton</td>
      <td>Scituate, Massachusetts, US</td>
      <td>D</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>Birmingham, West Midlands, England</td>
      <td>Southampton</td>
      <td>New York City</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>As with many datasets, there will be values that are not filled in. We can use the <code>fastai</code> module for this.<br></p>
<ul>
<li><strong>Categorify</strong> will convert the categorical values to something similar to <strong>pd.Categorical</strong>.<br></li>
<li><strong>FillMissing</strong> handles missing values differently depending on whether they are categorical or continuous.
<ul>
<li><strong>Categorical</strong>
<ul>
<li><code>#na</code> is used to fill in the missing values.</li>
</ul></li>
<li><strong>Continuous</strong>
<ul>
<li>The median is being used to fill in the missing values.</li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
<p>We want some of the data to be set aside so we can validate if our model is working on data it hasn't seen yet. This ensures that we know that our model has actually learnt from the data it is given.<br />
<strong>RandomSplitter</strong> facilitates this split of data by randomly selecting a percentage of the data to be used as validation data.</p>
<p><br></p>
<p><strong>cont_cat_split</strong> is used to separate the columns into continuous and categorical.</p>
</div>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>procedures <span class="op">=</span> [ Categorify, FillMissing ]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> RandomSplitter(valid_pct<span class="op">=</span><span class="fl">0.2</span>, seed<span class="op">=</span><span class="dv">42</span>)(range_of(df_train))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>cont, cat <span class="op">=</span> cont_cat_split(df_train, <span class="dv">1</span>, <span class="st">&#39;Survived&#39;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>display(Markdown(<span class="ss">f&#39;### </span><span class="sc">{</span><span class="bu">len</span>(cont)<span class="sc">}</span><span class="ss"> continuous features and </span><span class="sc">{</span><span class="bu">len</span>(cat)<span class="sc">}</span><span class="ss"> categorical features&#39;</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>display(cont)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>display(cat)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output display_data">
<pre><code>[&#39;PassengerId&#39;, &#39;Pclass&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;, &#39;Fare&#39;, &#39;Age_wiki&#39;, &#39;Class&#39;]</code></pre>
</div>
<div class="output display_data">
<pre><code>[&#39;Name&#39;,
 &#39;Sex&#39;,
 &#39;Ticket&#39;,
 &#39;Cabin&#39;,
 &#39;Embarked&#39;,
 &#39;Name_wiki&#39;,
 &#39;Hometown&#39;,
 &#39;Boarded&#39;,
 &#39;Destination&#39;,
 &#39;Lifeboat&#39;]</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>TabularPandas</strong> is a pandas dataframe on steroids.<br></p>
<ul>
<li><strong>Parameters</strong>
<ul>
<li>df: The pandas dataframe to be converted.</li>
<li>procs: The preprocessing steps to be applied.</li>
<li>cat_names: The names of the categorical columns.</li>
<li>cont_names: The names of the continuous columns.</li>
<li>y_names: The names of the target columns.</li>
<li>splits: The splits to be used.</li>
</ul></li>
</ul>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> TabularPandas(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>df_train,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    procs<span class="op">=</span>procedures,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    cat_names<span class="op">=</span>cat,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    cont_names<span class="op">=</span>cont,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    y_names<span class="op">=</span><span class="st">&#39;Survived&#39;</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    splits<span class="op">=</span>splits</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>to.show(<span class="dv">3</span>)</span></code></pre></div>
<div class="output display_data">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Ticket</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Name_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>Age_na</th>
      <th>Age_wiki_na</th>
      <th>Class_na</th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Age_wiki</th>
      <th>Class</th>
      <th>Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>788</th>
      <td>Dean, Master. Bertram Vere</td>
      <td>male</td>
      <td>C.A. 2315</td>
      <td>#na#</td>
      <td>S</td>
      <td>Dean, Master Bertram Vere</td>
      <td>Bartley Farm, Hampshire, England</td>
      <td>Southampton</td>
      <td>Wichita, Kansas, US</td>
      <td>10</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>789</td>
      <td>3</td>
      <td>1.0</td>
      <td>1</td>
      <td>2</td>
      <td>20.575001</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>525</th>
      <td>Farrell, Mr. James</td>
      <td>male</td>
      <td>367232</td>
      <td>#na#</td>
      <td>Q</td>
      <td>Farrell, Mr. James "Jim"</td>
      <td>Killoe, Longford, Ireland</td>
      <td>Queenstown</td>
      <td>New York City</td>
      <td>#na#</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>526</td>
      <td>3</td>
      <td>40.5</td>
      <td>0</td>
      <td>0</td>
      <td>7.750000</td>
      <td>25.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>821</th>
      <td>Lulic, Mr. Nikola</td>
      <td>male</td>
      <td>315098</td>
      <td>#na#</td>
      <td>S</td>
      <td>Lulić, Mr. Nikola</td>
      <td>Konjsko Brdo, Croatia</td>
      <td>Southampton</td>
      <td>Chicago, Illinois, US</td>
      <td>15</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>822</td>
      <td>3</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.662500</td>
      <td>29.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<section id="modeling" class="cell markdown">
<h1>Modeling</h1>
</section>
<section id="data-splits" class="cell markdown">
<h2>Data Splits</h2>
</section>
<div class="cell markdown">
<p>The <strong>TabularPandas</strong> dataframe knows that it is split into training and validation data. We also provided it a dependent variable to be used as the target. Therefore we can now split the data further, from training and validation data, to training and validation data separated by the <strong>features</strong> and the <strong>labels</strong>.</p>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>X_train, y_train <span class="op">=</span> to.train.xs, to.train.y</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>X_test, y_test <span class="op">=</span> to.valid.xs, to.valid.y</span></code></pre></div>
</div>
<section id="training" class="cell markdown">
<h2>Training</h2>
</section>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>model.fit(X_train.values, y_train.values)</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre><code>RandomForestClassifier(n_jobs=-1, random_state=42)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test.values)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_pred)</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>0.9887640449438202</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>X_test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Ticket</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Name_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>...</th>
      <th>Age_wiki_na</th>
      <th>Class_na</th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Age_wiki</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>303</th>
      <td>429</td>
      <td>1</td>
      <td>110</td>
      <td>117</td>
      <td>2</td>
      <td>406</td>
      <td>80</td>
      <td>3</td>
      <td>94</td>
      <td>2</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>304</td>
      <td>2</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>12.3500</td>
      <td>46.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>778</th>
      <td>439</td>
      <td>2</td>
      <td>451</td>
      <td>0</td>
      <td>2</td>
      <td>416</td>
      <td>100</td>
      <td>3</td>
      <td>148</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>779</td>
      <td>3</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.7375</td>
      <td>22.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>531</th>
      <td>819</td>
      <td>2</td>
      <td>182</td>
      <td>0</td>
      <td>1</td>
      <td>549</td>
      <td>167</td>
      <td>2</td>
      <td>148</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>532</td>
      <td>3</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.2292</td>
      <td>17.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>385</th>
      <td>206</td>
      <td>2</td>
      <td>622</td>
      <td>0</td>
      <td>3</td>
      <td>195</td>
      <td>247</td>
      <td>4</td>
      <td>63</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>386</td>
      <td>2</td>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
      <td>73.5000</td>
      <td>21.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>134</th>
      <td>773</td>
      <td>2</td>
      <td>553</td>
      <td>0</td>
      <td>3</td>
      <td>737</td>
      <td>306</td>
      <td>4</td>
      <td>100</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>135</td>
      <td>2</td>
      <td>25.0</td>
      <td>0</td>
      <td>0</td>
      <td>13.0000</td>
      <td>25.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>y_test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<pre><code>303    1.0
778    0.0
531    0.0
385    0.0
134    0.0
Name: Survived, dtype: float32</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>display(Markdown(<span class="ss">f&#39;### The predictions from the model vs. the real answer&#39;</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Model prediction:&#39;</span>, model.predict(X_test.loc[<span class="dv">303</span>].values.reshape(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>))[<span class="dv">0</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Target value:&#39;</span>, y_test.loc[<span class="dv">303</span>])</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;IPython.core.display.Markdown object&gt;</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Model prediction: 1.0
Target value: 1.0
</code></pre>
</div>
</div>
</body>
</html>
